\chapter{总结与展望}
\label{chap:conclusion}

\section{工作总结}

持久性内存系统可能对当前计算机体系结构产生重大影响。对于使用持久性内存系统的最佳接口方式，学术界和产业界都在积极地探讨，尚未得出统一的结论。而影响这一选择的最主要因素就是故障时数据一致性的机制设计及其性能开销。为此，我在博士研究期间，从三种最主要的访问接口入手，系统地研究了持久性内存中高效的故障时数据一致性保证机制：（1）对于文件系统接口，现有研究较为充分，本文定位在更好地利用手机移动环境的特定属性上。我们的工作不需要特殊的硬件改动，即可支持持久性内存的系统假设，通过多版本缓存事务和新的优化策略，显著提高了应用的响应度和系统的能量效率。（2）对于事务性内存接口，本文定位在提升当前工作的可扩展性，使该类持久性内存可应用于大容量的闪存存储。为此，我们采用了快照隔离对只读负载隐藏持久化开销，并设计了小缓冲区组技术，可同时实现事务的高吞吐和低延迟。（3）对于软件透明的接口，本文定位在高效的硬件设计，通过新的双模式检查点技术，高效地实现内存控制器对故障时数据一致性的支持。此外，我们还给出了软件透明的一致性协议的状态机表述和形式化证明。

\section{未来展望}

基于本文的工作，非易失性内存硬件可以在系统结构的不同层面、在不同的应用场景下发挥积极作用。将非易失性内存用在文件系统中，可以更加灵活地选择数据刷出到二级存储的时间，获得更好的整体性能；将非易失性存储应用在事务性内存中，可以降低持久化的延迟和对事务吞吐的负面影响；对软件透明的基于硬件实现的持久化机制，可以使应用开发人员更加方便地利用内存持久化的优势，并且可以提升上层软件的兼容性和可移植性。我们相信，本文研究工作将推动持久性内存系统的实际应用。

与此同时，持久性内存系统，特别是其故障时数据一致性保证机制，对软硬件协同设计有较高的要求。本文部分工作还可以继续扩展和优化，以达到更好的性能指标。特别地，对软件透明的故障时数据一致性机制对内存数据状态的保证与传统事务性软件有所不同。上层应用在系统故障恢复后可以从\emph{适度滞后}但是一致的内存状态继续执行，却会面临设备错误以及和其他分布式系统结点间的同步问题。这些软件系统层面的挑战可能驱动上层系统设计和实现的改变，以更好地挖掘持久性内存的潜力和价值。
